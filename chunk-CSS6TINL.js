import{a as se,b as pe}from"./chunk-3MIZ7XHY.js";import{a as me}from"./chunk-BDYQIMGW.js";import{a as ee,b as k,c as te,d as ie,e as ne,f as R,h as oe,j as re,k as ae,o as le}from"./chunk-UW56FJ2H.js";import{a as $}from"./chunk-QBNXAGIW.js";import"./chunk-SD2EQTYV.js";import"./chunk-CHFGLFWH.js";import{a as Z}from"./chunk-CL6Z4AWC.js";import{c as J}from"./chunk-LFWANRLE.js";import{b as K}from"./chunk-32VKKQHO.js";import{m as q,n as F}from"./chunk-2AUJZBLV.js";import{$ as E,Ab as D,Ha as P,Hb as M,Ka as r,La as _,Lb as d,Mb as u,Q as I,R as X,V as Y,a as j,aa as H,b as L,ba as A,bb as C,db as U,ia as v,ja as h,kb as o,lb as a,mb as g,nb as G,oa as S,ob as b,pa as x,ub as W,vb as z,wb as Q,yb as p,zb as m}from"./chunk-TKMI5VCA.js";var Ce=["imageElement"],ce=(()=>{let i=class i{constructor(e){this.el=e,this.lang=document.body.lang,this.imageUrl=null,this.save=new x,this.cancel=new x,this.isDragging=!1,this.dragStartX=0,this.dragStartY=0,this.imagePosition={x:0,y:0}}hireEvent(e){this.isDragging=!0;let{clientX:n,clientY:t}=this.getEventCoordinates(e);this.dragStartX=n,this.dragStartY=t}removeEvent(){this.isDragging=!1}startDrag(e){e.preventDefault(),this.hireEvent(e)}stopDrag(){this.removeEvent()}moveImage(e){if(this.isDragging){let{clientX:n,clientY:t}=this.getEventCoordinates(e);this.imagePosition.x+=n-this.dragStartX,this.imagePosition.y+=t-this.dragStartY,this.dragStartX=n,this.dragStartY=t}}getImageStyle(){return{transform:`translate(${this.imagePosition.x}px, ${this.imagePosition.y}px)`}}getEventCoordinates(e){return e instanceof MouseEvent?{clientX:e.clientX,clientY:e.clientY}:e instanceof TouchEvent&&e.touches.length>0?{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:{clientX:0,clientY:0}}crop(){let e=this.imageElement.nativeElement,t=document.getElementById("crop-box").getBoundingClientRect(),s=t.width,c=t.height,f=e.getBoundingClientRect(),fe=f.width,ve=f.height,T=e.naturalWidth/fe,N=e.naturalHeight/ve,he=(t.left-f.left)*T,be=(t.top-f.top)*N,V=s*T,O=c*N,y=document.createElement("canvas");y.width=V,y.height=O,y.getContext("2d")?.drawImage(e,he,be,V,O,0,0,V,O);let _e=y.toDataURL("image/png");this.save.emit(_e)}};i.\u0275fac=function(n){return new(n||i)(_(S))},i.\u0275cmp=E({type:i,selectors:[["image-cropper"]],viewQuery:function(n,t){if(n&1&&W(Ce,5),n&2){let s;z(s=Q())&&(t.imageElement=s.first)}},inputs:{imageUrl:"imageUrl"},outputs:{save:"save",cancel:"cancel"},standalone:!0,features:[M],decls:10,vars:4,consts:[["imageElement",""],[1,"cropper-container",3,"mousedown","touchstart","mouseleave","mouseup","touchend","mousemove","touchmove"],["id","uploadProfileImage","alt","Selected Image","draggable","false",3,"src","ngStyle"],[1,"crop-box-overlay"],["id","crop-box",1,"crop-box"],[1,"d-flex","align-items-center","gap-2","my-1"],[1,"w-100","cancel-btn",3,"click"],[1,"w-100","save-btn",3,"click"]],template:function(n,t){if(n&1){let s=G();o(0,"div",1),b("mousedown",function(f){return v(s),h(t.startDrag(f))})("touchstart",function(f){return v(s),h(t.startDrag(f))})("mouseleave",function(){return v(s),h(t.stopDrag())})("mouseup",function(){return v(s),h(t.stopDrag())})("touchend",function(){return v(s),h(t.stopDrag())})("mousemove",function(f){return v(s),h(t.moveImage(f))})("touchmove",function(f){return v(s),h(t.moveImage(f))}),g(1,"img",2,0)(3,"div",3)(4,"div",4),a(),o(5,"div",5)(6,"button",6),b("click",function(){return v(s),h(t.cancel.emit(!1))}),p(7),a(),o(8,"button",7),b("click",function(){return v(s),h(t.crop())}),p(9),a()()}n&2&&(r(),C("src",t.imageUrl,P)("ngStyle",t.getImageStyle()),r(6),m(t.lang=="en"?"cancel":"\u0625\u0644\u063A\u0627\u0621"),r(2),m(t.lang=="en"?"save":"\u062D\u0641\u0638"))},dependencies:[F,q],styles:["[_nghost-%COMP%]{display:block;width:100%}img[_ngcontent-%COMP%]{width:100%;object-fit:cover;position:absolute;cursor:pointer}.cropper-container[_ngcontent-%COMP%]{height:60vh;position:relative;overflow:hidden;width:100%;max-height:350px;background-color:#00000080}.crop-box[_ngcontent-%COMP%], .crop-box-overlay[_ngcontent-%COMP%]{width:200px;height:200px;position:absolute;inset:0;margin:auto;z-index:99;border-radius:100%}.crop-box-overlay[_ngcontent-%COMP%]{border-radius:0;width:100%;height:100%;background:radial-gradient(circle at center,transparent 100px,rgba(5,16,54,.245) 101px)}button[_ngcontent-%COMP%]{font-size:16px;background-color:transparent;outline:none;border:none;padding:8px 12px;cursor:pointer;border-radius:4px}.save-btn[_ngcontent-%COMP%]{background-color:rgb(var(--primary));color:#fff}.cancel-btn[_ngcontent-%COMP%]{background-color:rgb(var(--cancel))}"]});let l=i;return l})();var B=(()=>{let i=class i{loadImage(e){return new Promise((n,t)=>{e.length<=0&&t(null);let s=new FileReader;s.onload=c=>{n({base64:c.target.result,file:e[0]})},s.readAsDataURL(e[0])})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=I({token:i,factory:i.\u0275fac});let l=i;return l})();var de=(()=>{let i=class i{constructor(e,n){this.uploadController=e,this.el=n,this.onLoad=new x}onUpload(e){let n=e.target.files;this.uploadController.loadImage(n).then(t=>{let s=new FormData;s.append(this.el.nativeElement.name,t.file),this.onLoad.emit(L(j({},t),{formData:s}))})}};i.\u0275fac=function(n){return new(n||i)(_(B),_(S))},i.\u0275dir=A({type:i,selectors:[["input","ngUpload",""]],hostBindings:function(n,t){n&1&&b("change",function(c){return t.onUpload(c)})},outputs:{onLoad:"onLoad"}});let l=i;return l})();var ue=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=H({type:i}),i.\u0275inj=X({providers:[B],imports:[F,ce]});let l=i;return l})();var ge=(()=>{let i=class i{constructor(e){this.http=e,this.SERVER_URL=Z.baseUrl}update(e){let n=new FormData;return n.append("image",e.image.file),n.append("name",e.name),this.http.post(`${this.SERVER_URL}client/updateProfile`,n)}};i.\u0275fac=function(n){return new(n||i)(Y(K))},i.\u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"});let l=i;return l})();var Ze=(()=>{let i=class i{constructor(e,n){this.user=e,this.profileService=n,this.profileForm=new ne({image:new R(this.user.image||null,[k.required]),name:new R(this.user.name,[k.required])}),this.profileFormKeys=pe(this.profileForm),this.isInvalid=t=>se(this.profileForm,t)}onUpload(e){this.profileForm.controls.image.setValue(e)}updateProfile(){this.profileForm.markAllAsTouched(),!this.profileForm.invalid&&this.profileService.update(this.profileForm.value).subscribe(e=>e.status==200?me({message:e.msg}):null)}};i.\u0275fac=function(n){return new(n||i)(_($),_(ge))},i.\u0275cmp=E({type:i,selectors:[["app-profile"]],standalone:!0,features:[M],decls:90,vars:56,consts:[[1,"profile","mt-2"],[1,"container"],[1,"row"],[1,"col-md-8"],[1,"info","d-flex","gap-3","mb-3"],[1,"upload_profile_image"],["alt","profile image",1,"img-fluid","me-2",3,"src"],["for","upload"],["src","assets/images/upload.svg","alt","upload",1,"img-contain"],["name","image","id","upload","type","file","accept","images/*","ngUpload","",3,"onLoad"],[1,"d-flex","flex-column"],[1,"update"],[1,"form",3,"formGroup"],[1,"mb-5"],[1,"form"],[1,"row","mb-3"],["for","exampleInputEmail1",1,"col-sm-3","form-label"],[1,"col-sm-9"],["type","text",1,"form-control",3,"formControlName"],["type","text","disabled","","readonly","",1,"form-control",3,"value"],[1,"me-auto"],[1,"btn","btn-primary",3,"click"],[1,"form","mt-5"],["type","text",1,"form-control"],["type","submit",1,"btn","btn-primary","mt-2"],[1,"col-md-4"],[1,"subscribe"],["src","assets/images/subdcrib.gif","alt","",1,"img-fluid"],[1,"mb-1"]],template:function(n,t){n&1&&(o(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),g(6,"img",6),o(7,"label",7),g(8,"img",8),o(9,"input",9),b("onLoad",function(c){return t.onUpload(c)}),a()()(),o(10,"div",10)(11,"h3"),p(12),a(),o(13,"p"),p(14),a()()(),o(15,"div",11)(16,"form",12)(17,"h4",13),p(18),d(19,"translate"),a(),o(20,"div",14)(21,"div",15)(22,"label",16),p(23),d(24,"translate"),a(),o(25,"div",17),g(26,"input",18),a()(),o(27,"div",15)(28,"label",16),p(29),d(30,"translate"),a(),o(31,"div",17),g(32,"input",19),a()(),o(33,"div",15)(34,"label",16),p(35),d(36,"translate"),a(),o(37,"div",17),g(38,"input",19),a()(),o(39,"div",20)(40,"button",21),b("click",function(){return t.updateProfile()}),p(41),d(42,"translate"),a()()()(),o(43,"div",22)(44,"h4",13),p(45),d(46,"translate"),a(),o(47,"div",14)(48,"div",15)(49,"label",16),p(50),d(51,"translate"),a(),o(52,"div",17),g(53,"input",23),a()(),o(54,"div",15)(55,"label",16),p(56),d(57,"translate"),a(),o(58,"div",17),g(59,"input",23),a()(),o(60,"div",15)(61,"label",16),p(62),d(63,"translate"),a(),o(64,"div",17),g(65,"input",23),a()(),o(66,"button",24),p(67),d(68,"translate"),a()()()()(),o(69,"div",25)(70,"div",26),g(71,"img",27),o(72,"h4",28),p(73),d(74,"translate"),a(),o(75,"p"),p(76),d(77,"translate"),o(78,"strong"),p(79),d(80,"translate"),a()(),o(81,"p"),p(82),d(83,"translate"),a(),o(84,"p")(85,"small"),p(86),d(87,"translate"),g(88,"br"),p(89," 9 Mars 2025"),a()()()()()()()),n&2&&(r(5),U("invalid",t.isInvalid("image")),r(),C("src",(t.profileForm.controls.image==null||t.profileForm.controls.image.value==null?null:t.profileForm.controls.image.value.base64)||" assets/images/avatar-icon.svg",P),r(6),m(t.user.name),r(2),m(t.user.email),r(2),C("formGroup",t.profileForm),r(2),m(u(19,26,"profile.updateInformation")),r(5),m(u(24,28,"label.fullName")),r(2),U("invalid",t.isInvalid("name")),r(),C("formControlName",t.profileFormKeys.name),r(3),m(u(30,30,"label.yourEmail")),r(3),C("value",t.user.email),r(3),m(u(36,32,"label.yourPhone")),r(3),C("value",t.user.phone),r(3),m(u(42,34,"button.save")),r(4),m(u(46,36,"profile.securityInformation")),r(5),m(u(51,38,"profile.oldPassword")),r(6),m(u(57,40,"profile.oldPassword")),r(6),m(u(63,42,"profile.rePassword")),r(5),m(u(68,44,"button.save")),r(6),m(u(74,46,"profile.subscription")),r(3),D("",u(77,48,"profile.youAreNowIn")," "),r(3),m(u(80,50,"profile.basicPlan")),r(3),D("1 ",u(83,52,"profile.daysLeft"),""),r(4),D("",u(87,54,"profile.yourPremiumPlanWillExpireOn")," "))},dependencies:[ue,de,le,oe,ee,te,ie,re,ae,J],styles:[".upload_profile_image[_ngcontent-%COMP%]{position:relative}.upload_profile_image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;right:0;bottom:10px;width:30px;height:30px;display:block;cursor:pointer}.upload_profile_image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:lang(ar){right:unset;left:0}.upload_profile_image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{padding:5px;background-color:#fff;height:100%!important;width:100%}.upload_profile_image[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:red}"]});let l=i;return l})();export{Ze as ProfileComponent};
