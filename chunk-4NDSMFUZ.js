import{a as o}from"./chunk-BDYQIMGW.js";import{a as f}from"./chunk-QBNXAGIW.js";import{a as g}from"./chunk-CHFGLFWH.js";import{a as c}from"./chunk-CL6Z4AWC.js";import{b as i}from"./chunk-ZYLKLJZY.js";import{b as d,j as m}from"./chunk-32VKKQHO.js";import{M as r,Q as u,V as p}from"./chunk-TKMI5VCA.js";var a=class{constructor(s){this.http=s,this.SERVER_URL=c.baseUrl}register(s){return this.http.post(`${this.SERVER_URL}client/register`,s,{headers:{withLoader:"true"}})}verify(s){return this.http.post(`${this.SERVER_URL}client/verify`,s,{headers:{withLoader:"true"}})}resenCode(s){return this.http.post(`${this.SERVER_URL}client/resendCode`,s,{headers:{withLoader:"true"}})}login(s){return this.http.post(`${this.SERVER_URL}client/login`,s,{headers:{withLoader:"true"}})}forgetPassword(s){return this.http.post(`${this.SERVER_URL}client/forgotPassword`,s,{headers:{withLoader:"true"}})}verifyForgetPassword(s){return this.http.post(`${this.SERVER_URL}client/verifyForgetPassword`,s,{headers:{withLoader:"true"}})}resetPassword(s){return this.http.post(`${this.SERVER_URL}client/resetPassword`,s,{headers:{withLoader:"true"}})}};var $=(()=>{let s=class s extends a{constructor(e,t){super(e),this.userState=t,this.authSession=new h,this.router=g.get(m)}register(e){return super.register(e).pipe(r(t=>{[200,201].includes(t.status)&&(this.authSession.openOtpSession(e,"regsiter"),o({message:t.msg}),this.router.navigate([i.auth.otp]))}))}verifyOtp(e){return this.authSession.session.otp_type=="regsiter"?super.verify({code:e,email:this.authSession.session.otp_session?.email}).pipe(r(t=>{t.status==200&&(o({message:t.msg}),this.router.navigate([i.auth.login]))})):super.verifyForgetPassword({code:e,email:this.authSession.session.otp_session?.email}).pipe(r(t=>{t.status==200&&(o({message:t.msg}),this.router.navigate([i.auth.newPassword]))}))}resenCode(){return super.resenCode({email:this.authSession.session.otp_session?.email}).pipe(r(e=>e.status==200?o({message:e.msg}):null))}login(e){return super.login(e).pipe(r(t=>{[200,201].includes(t.status)&&(o({message:t.msg}),this.userState.updateUser(t.data),this.router.navigate([i.home]))}))}forgetPassword(e){return super.forgetPassword(e).pipe(r(t=>{t.status==200&&(this.authSession.openOtpSession(e,"forget_password"),this.router.navigate([i.auth.otp]))}))}newPassword(e){return super.resetPassword(e).pipe(r(t=>{t.status==200&&(this.authSession.session.otp_session={password:e.password},o({message:t.msg}),this.router.navigate([i.auth.login]))}))}};s.\u0275fac=function(t){return new(t||s)(p(d),p(f))},s.\u0275prov=u({token:s,factory:s.\u0275fac,providedIn:"root"});let n=s;return n})(),h=class{constructor(){this.session=JSON.parse(sessionStorage.getItem("authSession")),this.session||(this.session={otp_session:void 0,otp_type:void 0})}openOtpSession(s,l){this.session={otp_session:s,otp_type:l},sessionStorage.setItem("authSession",JSON.stringify(this.session))}};export{$ as a};
